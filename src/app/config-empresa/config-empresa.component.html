<app-navbar></app-navbar>

<style>
  /* Estilos para la ventana flotante */
  .ventana-flotante {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    width: auto;
    height: auto;
    padding: 20px;
    border: 1px solid black;
    border-radius: 3%;
    box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.3);
    display: none;
    /* La ventana estará oculta inicialmente */
  }
</style>


<section id="fondo" class="pedido-block">
  <div class="encabezado"
    style="right: auto; flex-direction: column; align-items: flex-start; justify-content: center; display: flex;">
    <h1 style="margin-left: 1rem;">Configuración de la empresa</h1>
  </div>

  <button class="btn btn-custom" onclick="mostrarVentana(document.getElementById('ventana'))"  style="margin-left: 10px;">
    <span class="icon">
      <img src="assets/imagenes/add.png" alt="Imagen de búsqueda">
    </span>
    <span class="text">Ingresar empresa</span>
  </button>

  <div id="ventana" class="ventana-flotante">
    <h1>Ingresar Empresa</h1>

    <div class="container">
      <form #empresaForm="ngForm" (ngSubmit)="guardarEmpresa()">
        <div class="form-group">
          <label for="nombreEmpresa">Nombre de la empresa:</label>
          <input type="text" class="form-control" id="nombreEmpresa" [(ngModel)]="empresai.nombreEmpresa"
            name="nombreEmpresa" required>
          <div *ngIf="empresaForm.controls['nombreEmpresa'].invalid && empresaForm.controls['nombreEmpresa'].touched"
            class="error-message">Nombre de la empresa es requerido.</div>
        </div>

<div class="form-group">
  <label for="ruc">RUC:</label>
  <input type="text" class="form-control" id="ruc" [(ngModel)]="empresai.ruc" name="ruc" required pattern="[0-9]{13}">
  <div *ngIf="empresaForm.controls['ruc'].invalid && empresaForm.controls['ruc'].touched" class="error-message">
    <div *ngIf="empresaForm.controls['ruc'].hasError('required')">El RUC es requerido.</div>
    <div *ngIf="empresaForm.controls['ruc'].hasError('pattern')">El RUC debe tener exactamente 13 dígitos numéricos.</div>
  </div>
</div>

 <div class="form-group">
          <label for="ubicacion">Dirección:</label>
          <input type="text" class="form-control" id="ubicacion" [(ngModel)]="empresai.ubicacion" name="ubicacion"
            required>
          <div *ngIf="empresaForm.controls['ubicacion'].invalid && empresaForm.controls['ubicacion'].touched"
            class="error-message">La dirección es requerida.</div>

        </div>

<div class="form-group">
  <label for="telefono">Teléfono:</label>
  <input type="text" class="form-control" id="telefono" [(ngModel)]="empresai.telefono" name="telefono" required pattern="[0-9]{10}">
  <div *ngIf="empresaForm.controls['telefono'].invalid && empresaForm.controls['telefono'].touched" class="error-message">
    <div *ngIf="empresaForm.controls['telefono'].hasError('required')">El teléfono es requerido.</div>
    <div *ngIf="empresaForm.controls['telefono'].hasError('pattern')">El número de teléfono debe tener 10 dígitos.</div>
  </div>
</div>

<div class="form-group">
  <label for="iva">Iva:</label>
<input type="number" class="form-control" id="iva" [(ngModel)]="empresai.iva" name="iva" required
pattern="0.01" step="0.01">
<div *ngIf="empresaForm.controls['iva'].invalid && empresaForm.controls['iva'].touched" class="error-message">
<div *ngIf="empresaForm.controls['iva'].hasError('required')">Se requiere el iva.</div>
<div *ngIf="empresaForm.controls['iva'].hasError('pattern')">El IVA debe ser un decimal de dos dígitos.</div>
</div>
   
 
</div>

<button type="submit" class="btn btn-custom" onclick="guardarEmpresa(); limpiarFormulario();">
  <span class="icon">
    <img src="assets/imagenes/save.png" alt="Imagen de búsqueda">
    <span class="text">Guardar</span>
  </span>
 
</button>

<button type="button" class="btn btn-custom"  onclick="cerrarVentana();">
  <span class="icon">
    <img src="assets/imagenes/cancelar.png" alt="Imagen de búsqueda">
    <span class="text">Cancelar</span>
  </span>
 
</button>

      </form>
    </div>
  </div>

  <div style="height: 210px; overflow-y: scroll;">
  <table class="custom-table">
    <thead>
      <tr>
        <th scope="col">Número</th>
        <th scope="col">Nombre de la Empresa</th>
        <th scope="col">Ruc</th>
        <th scope="col">Dirección</th>
        <th scope="col">Teléfono</th>
        <th scope="col">Iva</th>
        <th scope="col">Editar</th>
        <th scope="col">Eliminar</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let empresa of empresas">
        <td>{{empresa.idConfig}}</td>
        <td>{{empresa.nombreEmpresa}}</td>
        <td>{{empresa.ruc}}</td>
        <td>{{empresa.ubicacion}}</td>
        <td>{{empresa.telefono}}</td>
        <td>{{empresa.iva}}</td>
        <td>
          <button (click)= "actualizarEmpresa(empresa.idConfig)" class="btn btn-custom">
            <span class="icon">
              <img src="assets/imagenes/editar.png" alt="Imagen de búsqueda">
            </span>
           
          </button>
        </td>

        <td>
            <button (click)= "eliminarEmpresa(empresa.idConfig)" class="btn btn-custom">
              <span class="icon">
                <img src="assets/imagenes/eliminar.png" alt="Imagen de búsqueda">
              </span>
            </button>
            </td>
      </tr>
    </tbody>
  </table>
</div>
</section>